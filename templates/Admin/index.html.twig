{# src/utb/AdminBundle/Resources/views/Admin/index.html.twig #}
{% extends "utbAdminBundle::layoutAdmin.html.twig" %}
{% block title %}
  {{ parent() }} - {{ 'admin.espaceadminaccueil'|trans}}
{% endblock %}  
        
{% block administration_body %}
  				<!-- FIN MENU RAPIDE BAR HORIZONTALE GRISE -->

<div class="span-25 colorBleu" id="filAriane">	<!-- Fil d'ariane conducteur Tableau de bord > Gestion article > Modifier -->
    <a href="{{path('utb_admin_accueil',{ 'locale': locale })}}"> {{ 'admin.accueil'|trans}}</a>
</div>
            
<div class="span-25">			<!-- TOUTE LA PAGE CENTRALE : MODULES + DETAILS -->
      {% for message in app.session.flashbag.get('accesdenied') %}
        <div class="error errorMsg">{{ message|trans }}</div>
      {% endfor %} 
    <div id="tableauBord" class="coinsArrondis colorCadreArrondi bgGris">
            <div class="boxAllRubriquesBOX">	<!-- span-13 -->	
            <div class="boxAllRubriques">
                     <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="{{path('utb_admin_arbre', {'locale': locale})}}" title="{{ 'admin.layout.arbre'|trans}}">
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-arbre.png')}}" alt="{{ 'admin.layout.arbre'|trans}}" title="{{ 'admin.layout.arbre'|trans}}" /></div>
                                    <span>{{ 'admin.layout.arbre'|trans}}</span>
                            </a> 
                     </div>
					 <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="{{path('utb_admin_accueilbanniere', {'locale': locale})}}" title="{{ 'admin.accueil'|trans}}">
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-frontpage.png')}}" alt="{{ 'admin.accueil'|trans}}" title="{{ 'admin.accueil'|trans}}" /></div>
                                    <span class="nomModule">{{'admin.banniereaccueil'|trans}}</span>
                            </a> 
                    </div>
                    
                     <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="{{path('utb_admin_listetoutarticle', {'locale': locale})}}" title="{{ 'admin.layout.menu.titreart'|trans}}">
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-article.png')}}" alt="{{ 'admin.layout.menu.articles'|trans}}" title="{{ 'admin.layout.menu.titreart'|trans}}" /></div>
                                    <span>{{ 'admin.layout.menu.articles'|trans}}</span>
                            </a> 
                    </div>
                     <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="{{path('utb_admin_listerubrique', {'locale': locale})}}" title="{{ 'admin.layout.menu.titrerub'|trans}}">
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-category.png')}}" alt="{{ 'admin.layout.menu.titrerub'|trans}}" title="{{ 'admin.layout.menu.titrerub'|trans}}" /></div>
                                    <span>{{ 'admin.layout.menu.rubriques'|trans}}</span>
                            </a> 
                    </div>
                     <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="{{path('utb_admin_menus',{'locale':locale})}}" title="{{ 'admin.layout.menu.titremenu'|trans}}">
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-menumgr.png')}}" alt="{{ 'admin.layout.menu.menus'|trans}}" title="{{ 'admin.layout.menu.titremenu'|trans}}" /></div>
                                    <span>{{ 'admin.layout.menu.menus'|trans}}</span>
                            </a> 
                    </div>
                   <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="{{path('utb_admin_listecadre',{'locale':locale})}}" title="{{ 'admin.layout.menu.titrecadre'|trans}}">
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-themes.png')}}" alt="{{ 'admin.layout.menu.cadre'|trans}}" title="{{ 'admin.layout.menu.titrecadre'|trans}}" /></div>
                                    <span>{{ 'admin.layout.menu.cadre'|trans}}</span>
                            </a> 
                    </div>
                     <!--  
                     <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="" title="{{ 'admin.layout.menu.titremediatek'|trans}}" >
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-media.png')}}" alt="{{ 'admin.layout.menu.mediatek'|trans}}" title="{{ 'admin.layout.menu.titremediatek'|trans}}" /></div>
                                    <span>{{ 'admin.layout.menu.mediatek'|trans}}</span>
                            </a> 
                    </div> -->
                    
                     <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="{{path('utb_admin_listemessage',{'locale':locale})}}" title="{{ 'admin.layout.menu.titremessag'|trans}}" >
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-new-privatemessage.png')}}" alt="{{ 'admin.layout.menu.messagerie'|trans}}" title="{{ 'admin.layout.menu.titremessag'|trans}}" /></div>
                                    <span>{{ 'admin.layout.menu.messagerie'|trans}}</span>
                            </a> 
                    </div>
                    <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="{{path('utb_admin_listeservice', {'locale': locale})}}" title="{{ 'admin.layout.titrecontact'|trans}}">
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-menu.png')}}" alt="{{ 'admin.layout.contact'|trans}}" title="{{ 'admin.layout.titrecontact'|trans}}" /></div>
                                    <span>{{ 'admin.layout.contact'|trans}}</span>
                            </a> 
                    </div>
                    <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="{{path('utb_admin_listeboxinfos',{'locale':locale})}}" title="{{ 'admin.layout.menu.titremaint'|trans}}">
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-config.png')}}" alt="{{ 'admin.layout.menu.maintenance'|trans}}" title="{{ 'admin.layout.menu.titremaint'|trans}}" /> </div>
                                    <span>{{ 'admin.layout.menu.maintenance'|trans}}</span>
                            </a> 
                    </div>
					 <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="{{path('utb_admin_userProfilListe', {'locale': locale})}}" title="{{ 'admin.layout.menu.titreusers'|trans}}">
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-45-user.png')}}" alt="{{ 'admin.layout.menu.users'|trans}}" title="{{ 'admin.layout.menu.titreusers'|trans}}" /></div>
                                    <span>{{ 'admin.layout.menu.loginprof'|trans}}</span>
                            </a> 
                    </div>
                     <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="{{path('utb_admin_droit',{'locale':locale})}}" title="{{ 'admin.layout.titredroitsacces'|trans}}">
                                    <div class="logoModule"> <img src="{{ asset('img/admin-img/icon-48-cpanel.png')}}" alt="{{ 'admin.layout.droitsacces'|trans}}" title="{{ 'admin.layout.titredroitsacces'|trans}}" /></div>
                                    <span>{{ 'admin.layout.droitsacces'|trans}}</span>
                            </a> 
                    </div>

                    <!-- <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="" title="{{ 'admin.layout.titrecours'|trans}}">
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-devises.png')}}" alt="{{ 'admin.layout.cours'|trans}}" title="{{ 'admin.layout.titrecours'|trans}}" /></div>
                                    <span>{{ 'admin.layout.cours'|trans}}</span>
                            </a> 
                    </div>
                    <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="" title="{{ 'admin.layout.rechercher'|trans}}" >
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-search.png')}}" alt="{{ 'admin.layout.rechercher'|trans}}" title="{{ 'admin.layout.rechercher'|trans}}" /></div>
                                    <span>{{ 'admin.layout.rechercher'|trans}}</span>
                            </a> 
                    </div>
                     -->
                     <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="{{path('utb_admin_listesondage', {'locale': locale})}}" title="{{ 'admin.layout.titresondage'|trans}}">
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/icon-48-levels.png')}}" alt="{{ 'admin.layout.sondage'|trans}}" title="{{ 'admin.layout.titresondage'|trans}}" /></div>
                                    <span>{{ 'admin.layout.sondage'|trans}}</span>
                            </a> 
                     </div>
                     
                    
                     
                    <!-- <div class="ilustreModule bgBlanc coinsArrondisMin">
                            <a class="defaultColor hoverBleu" href="" title="{{ 'admin.layout.titrenews'|trans}}">
                                    <div class="logoModule"><img alt="image" src="{{ asset('img/admin-img/icon-48-calendar.png')}}" title="{{ 'admin.layout.titrenews'|trans}}" /></div>
                                    <span>{{ 'admin.layout.news'|trans}}</span>
                            </a> 
                    </div> -->
					<div class="ilustreModule bgBlanc coinsArrondisMin">
                         {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
                            <a class="defaultColor hoverBleu" href="{{ path('fos_user_security_logout') }}">
                                    <div class="logoModule"><img src="{{ asset('img/admin-img/ball-cute-shutdown-icone.png')}}" alt="{{ 'admin.layout.deconect'|trans}}" title="{{ 'admin.layout.deconect'|trans}}" /></div>
                                    <span>{{ 'admin.layout.deconect'|trans}}</span>
                            </a> 
                           {% endif %}     
                    </div>
                                                               
                    <div class="clr"></div>
            </div>
            </div> <!-- FIN SPAN 13-->

            <div class="boxVisualRubriqBOX"> 	<!-- span-11 last -->			
            <div class="boxVisualRubriq" > 		<!-- PARTIE DROITE AVEC ACORDEON etc.-->
                    <div id="accordion">
                        {% for texte in letexte %}
                            {% if texte.titre is not null %}
                            <h3><strong>{{texte.titre|raw}}</strong></h3>                      
                            <div>
                               <p><img src="{{ asset('img/admin-img/logomidle-utb.png')}}" class="logoMiddleSociete"  alt="" title="" /> <p>{{texte.description|raw}}</p>
                            </div>  
                            {% endif %}   
                        {% endfor %}
                    
                            <h3>{{ 'admin.index.artrecentpub'|trans}}</h3>
                            <div>
                                    <table class="listMenusCateg listArticlesRub">
                                            
                                            {{ information.titreslistearcordeon() }}
                                        
                                            {% for article in listearticlerecent %}
                                                {% if article.titreArticle is not null %}
                                                <tr {% if loop.index is divisibleby(2) %} class="bgBlanc"{% else %} class="bgGris" {% endif %}>
                                                        <td class="numArtList" style="width:80px"> {{'N°'~article.id}}</td>
                                                        <td class="titreArtList"><a href="{{ path('utb_admin_detailarticle', {'id': article.id,'locale': locale,'type': article.idrubrique}) }}" >{{article.titreArticle}}</a></td>
                                                        
                                                        {{ information.statutlisteaccordeon(article) }}
                                                        
                                                        <td class="autorArtList">
                                                            {% for user in listeuser %}
                                                                {% if user.id == article.articleAjoutPar  %}
                                                                     {{user.NameUser}}
                                                                {% endif %}
                                                            {% endfor %}                                                                                    
                                                        </td>
                                                        <td class="dateArtList"> {{article.articleDateAjout|date("d/m/Y")}}</td>
                                                        <td class="langArtList"> {{locale}}</td>
                                                </tr>
                                                {% endif %} 
                                            {% endfor %}
                                           
                                    </table>
                                    {% if (listearticlerecent is not null) and (listearticlerecent|length>0) %}
                                        <div class="listecomplete"><a href="{{ path('utb_admin_ListeParStatut', {'id': 0,'page': 1,'statut': 4,'locale': locale}) }}
                                                                      " >{{ 'admin.voirtout'|trans}}</a></div>
                                    {% endif %}    
                            </div>

                            <h3>{{ 'admin.index.artattentepub'|trans}}</h3>
                            <div>
                                    <table class="listMenusCateg listArticlesRub">
                                            
                                           {{ information.titreslistearcordeon() }} 
                                        
                                           {% for article in listearticleattente %}
                                                {% if article.titreArticle is not null %}
                                                <tr {% if loop.index is divisibleby(2) %} class="bgBlanc"{% else %} class="bgGris" {% endif %}>
                                                        <td class="numArtList"  style="width:80px"> {{'N°'~article.id}}</td>
                                                        <td class="titreArtList"><a href="{{ path('utb_admin_detailarticle', {'id': article.id,'locale': locale,'type': article.idrubrique}) }}" >{{article.titreArticle}}</a></td>
                                                        
                                                        {{ information.statutlisteaccordeon(article) }}
                                                        
                                                        <td class="autorArtList">
                                                            {% for user in listeuser %}
                                                                {% if user.id == article.articleAjoutPar  %}
                                                                     {{user.NameUser}}
                                                                {% endif %}
                                                            {% endfor %}                                                                                    
                                                        </td>
                                                        <td class="dateArtList"> {{article.articleDateAjout|date("d/m/Y")}}</td>
                                                        <td class="langArtList"> {{locale}}</td>
                                                </tr>
                                                {% endif %} 
                                            {% endfor %}
                                    </table>
                                    {% if (listearticleattente is not null) and (listearticleattente|length>0) %}
                                        <div class="listecomplete">
                                            <a href="
                                                    {{ path('utb_admin_ListeParStatut', {'id': 0,'page': 1,'statut': 3,'locale': locale}) }}
                                                    " >
                                                {{ 'admin.voirtout'|trans}}
                                            </a>
                                        </div>
                                    {% endif %} 
                            </div>
                            
                            <h3>{{ 'admin.index.artsoumis'|trans}}</h3>
                            <div>
                                    <table class="listMenusCateg listArticlesRub">
                                        
                                           {{ information.titreslistearcordeon() }}	
                                        
                                           {% for article in listearticlesoumis %}
                                                {% if article.titreArticle is not null %}
                                                <tr {% if loop.index is divisibleby(2) %} class="bgBlanc"{% else %} class="bgGris" {% endif %}>
                                                        <td class="numArtList"  style="width:80px"> {{'N°'~article.id}}</td>
                                                        <td class="titreArtList">
                                                            <a href="{{ path('utb_admin_detailarticle', {'id': article.id,'locale': locale,'type': article.idrubrique}) }}" >{{article.titreArticle}}</a></td>
                                                       
                                                        {{ information.statutlisteaccordeon(article) }}
                                                        
                                                        <td class="autorArtList">
                                                            {% for user in listeuser %}
                                                                {% if user.id == article.articleAjoutPar  %}
                                                                     {{user.NameUser}}
                                                                {% endif %}
                                                            {% endfor %}                                                                                    
                                                        </td>
                                                        
                                                        <td class="dateArtList"> {{article.articleDateAjout|date("d/m/Y")}}</td>
                                                        <td class="langArtList"> {{locale}}</td>
                                                </tr>
                                                {% endif %} 
                                            {% endfor %}
                                    </table>
                                    {% if (listearticlesoumis is not null) and (listearticlesoumis|length>0) %}
                                        <div class="listecomplete"><a href=" {{ path('utb_admin_ListeParStatut', {'id': 0,'page': 1,'statut': 2,'locale': locale}) }}" >{{ 'admin.voirtout'|trans}}</a></div>
                                    {% endif %} 
                            </div>                            
                            
                            
                    </div>		<!-- FIN des accordéons -->
            </div>			<!-- FIN boxVisualRubriq APercus -->
            </div>			<!-- FIN SPAN - 12 -->
            <div class="clr"></div>
    </div> <!-- FIN tableauBord -->
</div> 	<!-- FIN SPAN - 25 --> 

                      <div id="form_a_container" style="display:none;">
                                  <form id="form_addArticle">
                                    <div class="clr"></div>
                                     <p id="form_rubrique_container">
                                         <span class="colorBleu"><label>{{ 'articles.selectRubrique'|trans({}, 'articles')}}<label></span> 
                                                     <select id="rubrique" name="rubrique">
                                                         {% for rb in listeRubrique %}
                                                             <option value="{{rb.getId}}">{{rb.getNomRubrique}}</option>
                                                         {% endfor %}    
                                                     </select>          
                                     </p> 
                                  </form>   
                        </div>  

 <script language="javascript" >
     
       function ajouterArticle(){
           var args = {modal: true, autoOpen: false, title: ('Ajouter un article'), width:400,height:200};
           $('#form_a_container').dialog(args);
           var rubrique;
           rubrique  = $("#rubrique").val();

               $('#form_a_container').dialog({
                   
                   buttons: {
                           "OK": function() {
                               
                                $.ajax({
                                   type: "POST",
                                   url: "{{ path('utb_admin_addArticle')}}",
                                   data: {formdata:$("#form_addArticle").serialize()},
                                   cache: false,
                                   success: function(data){
                                        var resJson = jQuery.parseJSON(data);
                                        window.location = resJson.url;
                                   }
                               });                             
                           },                   
                           "Cancel": function() {
                               $(this).dialog("close");
                           }
                   }
               })             
              $('#form_a_container').dialog('open');          
       }
  </script>  


{% endblock %}
